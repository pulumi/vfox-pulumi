[env]
MISE_USE_VERSIONS_HOST = "0"
ASDF_LUA_LUAROCKS_VERSION = "3.12.2" # https://github.com/jdx/mise-tool-plugin-template/issues/6
_.path = { path = ["lua_modules/bin"], tools = true }

[tools]
actionlint = "latest"
hk = "latest"
lua = "5.4.8"
pkl = "latest"
pulumi = "latest"
stylua = "latest"

[tasks.install-deps]
description = "Install Lua dependencies"
run = "bash scripts/install-deps.sh"

[tasks.format]
description = "Format Lua scripts"
run = "stylua metadata.lua hooks/"

[tasks.lint]
description = "Lint Lua scripts and GitHub Actions using hk"
run = "hk check"

[tasks.unit]
description = "Run lua unit tests"
depends = ["install-deps"]
run = "busted -v"

[tasks.ci]
description = "Run all CI checks"
depends = ["lint", "unit"]

[settings]
experimental = true
